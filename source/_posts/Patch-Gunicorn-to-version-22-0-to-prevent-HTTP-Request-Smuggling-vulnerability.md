---
title: Patch Gunicorn to version 22.0 to prevent HTTP Request Smuggling vulnerability
date: 2024-05-01 23:03:37
tags:
 - gunicorn
 - request smuggling exploit
 - github advisory
 - CVE-2024-1135
 - huntr
 - nist

---
## Which version(s) are affected?
Hey fellow readers, if you're deploying your python application or containerized application through Gunicorn (Green Unicorn) there is a new vulnerability that bypasses validation when == multiple conflicting Transfer-Encoding headers == are used which are treated as chunked data regardlesss of final encoding leading to Request Smuggling allowing access to restricted API endpoints in your application without needed credentials/tokens.
<!-- more -->

The new update version 22.0 fixes the issue mentioned in the [commit](https://github.com/benoitc/gunicorn/commit/ac29c9b0a758d21f1e0fb3b3457239e523fa9f1d).

The PoC for the exploit can be found here at [Huntr](https://huntr.com/bounties/22158e34-cfd5-41ad-97e0-a780773d96c1).

In short, versions < 22.0 are affected. You can update it manually to the fixed version via pip or pipenv or conda. If they are unable to update the package, the best way would be to secure the endpoints via firewall and block access.

## Source(s)
- [Github Advisory](https://github.com/advisories/GHSA-w3h3-4rj7-4ph4)
- [NIST Advisory](https://nvd.nist.gov/vuln/detail/CVE-2024-1135)
- [Huntr Advisory](https://huntr.com/bounties/22158e34-cfd5-41ad-97e0-a780773d96c1)
- [Gunicorn Commit](benoitc/gunicorn@ac29c9b)
- [Gunicorn Releases](https://github.com/benoitc/gunicorn/releases/tag/22.0.0)
