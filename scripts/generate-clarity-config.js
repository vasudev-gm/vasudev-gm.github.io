const fs = require('fs');
const path = require('path');

// Load local .env when present (development). This is optional; dotenv is a dev dep.
try {
    require('dotenv').config({ path: require('path').join(__dirname, '..', '.env') });
} catch (e) {
    // dotenv may not be installed in every environment; ignore if missing
}

const projectId = process.env.MSFT_CLARITY || '';
const outDir = path.join(__dirname, '..', 'source', 'js');
const outFile = path.join(outDir, 'clarity-config.js');

if (!fs.existsSync(outDir)) fs.mkdirSync(outDir, { recursive: true });

const content = `// Generated by scripts/generate-clarity-config.js\nwindow.__CLARITY_PROJECT_ID__ = ${JSON.stringify(projectId)};\n`;
fs.writeFileSync(outFile, content, 'utf8');
console.log('Wrote', outFile, 'projectId=', projectId ? '***hidden***' : '(empty)');
